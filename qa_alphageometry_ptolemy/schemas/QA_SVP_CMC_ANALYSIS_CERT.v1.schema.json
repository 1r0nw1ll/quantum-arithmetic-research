{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "QA_CERT__SVP_CMC_ANALYSIS.v1",
  "title": "QA SVP-CMC Analysis Certificate v1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "cert_type",
    "cert_id",
    "subject",
    "scalar",
    "disturbance",
    "latency",
    "kinetics",
    "impossibles",
    "trace",
    "sha256_manifest"
  ],
  "properties": {
    "schema_version": { "type": "string", "const": "qa_cert.v1" },
    "cert_type": { "type": "string", "const": "QA_CERT__SVP_CMC_ANALYSIS.v1" },
    "cert_id": { "type": "string", "pattern": "^[A-Z0-9_\\-\\.]{8,128}$" },
    "subject": {
      "type": "object",
      "additionalProperties": false,
      "required": ["subject_id", "subject_type", "prompt_text"],
      "properties": {
        "subject_id": { "type": "string" },
        "subject_type": {
          "type": "string",
          "enum": ["device", "organism", "phenomenon", "state", "question", "protocol"]
        },
        "prompt_text": { "type": "string" }
      }
    },
    "scalar": {
      "type": "object",
      "additionalProperties": false,
      "required": ["architecture", "neutral_centers", "symmetry", "persistence"],
      "properties": {
        "architecture": {
          "type": "object",
          "additionalProperties": false,
          "required": ["geometry", "materials", "polarity", "boundary_conditions"],
          "properties": {
            "geometry": { "type": "string" },
            "materials": { "type": "string" },
            "polarity": { "type": "string" },
            "boundary_conditions": { "type": "string" }
          }
        },
        "neutral_centers": { "type": "array", "items": { "type": "string" } },
        "symmetry": { "type": "string" },
        "persistence": {
          "type": "object",
          "additionalProperties": false,
          "required": ["resists", "invariants"],
          "properties": {
            "resists": { "type": "array", "items": { "type": "string" } },
            "invariants": { "type": "array", "items": { "type": "string" } }
          }
        },
        "parameters": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "subdivision_frequency_band": { "type": "string" },
            "phase_relationships": { "type": "string" },
            "angle_orientation": { "type": "string" },
            "amplitude_degree": { "type": "string" },
            "polarity_arrangement": { "type": "string" },
            "neutral_center_placement": { "type": "string" },
            "disturbance_rate": { "type": "string" }
          }
        }
      }
    },
    "disturbance": {
      "type": "object",
      "additionalProperties": false,
      "required": ["generator_id", "parameters"],
      "properties": {
        "generator_id": { "type": "string" },
        "parameters": {
          "type": "object",
          "additionalProperties": false,
          "required": ["type", "rate", "direction", "magnitude"],
          "properties": {
            "type": { "type": "string" },
            "rate": { "type": "string" },
            "direction": { "type": "string" },
            "magnitude": { "type": "string" }
          }
        }
      }
    },
    "latency": {
      "type": "object",
      "additionalProperties": false,
      "required": ["response_order", "lags_and_causes"],
      "properties": {
        "response_order": { "type": "array", "items": { "type": "string" } },
        "lags_and_causes": { "type": "array", "items": { "type": "string" } },
        "path_metrics": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "min_steps": { "type": "integer", "minimum": 0 },
            "return_in_k": { "type": "integer", "minimum": 0 }
          }
        }
      }
    },
    "kinetics": {
      "type": "object",
      "additionalProperties": false,
      "required": ["permitted", "observed"],
      "properties": {
        "permitted": { "type": "array", "items": { "type": "string" } },
        "observed": { "type": "array", "items": { "type": "string" } }
      }
    },
    "impossibles": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["effect", "obstruction_id", "reason"],
        "properties": {
          "effect": { "type": "string" },
          "obstruction_id": { "type": "string" },
          "reason": { "type": "string" }
        }
      }
    },
    "trace": {
      "type": "object",
      "additionalProperties": false,
      "required": ["moves"],
      "properties": {
        "moves": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["move", "invariant_diff"],
            "properties": {
              "move": { "type": "string" },
              "fail_type": { "type": "string" },
              "invariant_diff": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "before": { "type": "object" },
                  "after": { "type": "object" }
                }
              }
            }
          }
        }
      }
    },
    "sha256_manifest": { "type": "string", "pattern": "^[a-f0-9]{64}$" }
  }
}
