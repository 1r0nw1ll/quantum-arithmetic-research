{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "QA_SUBMISSION_PACKET_SPINE.v1.schema.json",
  "title": "QA_SUBMISSION_PACKET_SPINE.v1",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version", "packet_id", "created_utc", "target_journal",
    "relationship_to_primary", "mirrored_claims_lock",
    "companion_paper_scope", "certificate_plan", "submission_assets"
  ],
  "properties": {
    "schema_version": { "const": "QA_SUBMISSION_PACKET_SPINE.v1" },
    "packet_id": { "type": "string", "minLength": 1 },
    "created_utc": {
      "type": "string",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$"
    },
    "target_journal": { "type": "string", "minLength": 1 },
    "relationship_to_primary": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "primary_manuscript_title", "primary_author",
        "relationship", "non_drift_rule"
      ],
      "properties": {
        "primary_manuscript_title": { "type": "string", "minLength": 1 },
        "primary_author": { "type": "string", "minLength": 1 },
        "relationship": {
          "type": "string",
          "enum": ["companion_or_complement", "appendix", "replication", "commentary", "response"]
        },
        "non_drift_rule": { "type": "string", "minLength": 1 }
      }
    },
    "mirrored_claims_lock": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["claim", "refs"],
        "properties": {
          "claim": { "type": "string", "minLength": 1 },
          "refs": {
            "type": "array",
            "minItems": 1,
            "items": { "type": "string", "minLength": 1 }
          }
        }
      }
    },
    "companion_paper_scope": {
      "type": "object",
      "additionalProperties": false,
      "required": ["what_we_add", "what_we_do_not_add"],
      "properties": {
        "what_we_add": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        },
        "what_we_do_not_add": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        }
      }
    },
    "certificate_plan": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["certificate_type", "basis", "refs"],
        "properties": {
          "certificate_type": { "type": "string", "minLength": 1 },
          "basis": { "type": "string", "minLength": 1 },
          "refs": {
            "type": "array",
            "minItems": 1,
            "items": { "type": "string", "minLength": 1 }
          }
        }
      }
    },
    "submission_assets": {
      "type": "object",
      "additionalProperties": false,
      "required": ["cover_letter_alignment_points", "refs"],
      "properties": {
        "cover_letter_alignment_points": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        },
        "refs": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        }
      }
    }
  }
}
