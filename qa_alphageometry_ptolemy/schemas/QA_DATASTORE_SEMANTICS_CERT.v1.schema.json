{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "QA_DATASTORE_SEMANTICS_CERT.v1.schema.json",
  "title": "QA Datastore Semantics Certificate v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema_id", "version", "fail_types", "hash_domains", "merkle", "manifest"],
  "properties": {
    "schema_id": { "type": "string", "const": "QA_DATASTORE_SEMANTICS_CERT.v1" },
    "version": { "type": "integer", "const": 1 },
    "fail_types": {
      "type": "array",
      "items": { "type": "string", "minLength": 1 },
      "minItems": 6,
      "uniqueItems": true
    },
    "hash_domains": {
      "description": "Domain separation prefixes. Must be distinct and non-empty.",
      "type": "object",
      "additionalProperties": false,
      "required": ["record", "keyed_leaf", "merkle_node", "cert"],
      "properties": {
        "record": { "type": "string", "minLength": 1 },
        "keyed_leaf": { "type": "string", "minLength": 1 },
        "merkle_node": { "type": "string", "minLength": 1 },
        "cert": { "type": "string", "minLength": 1 }
      }
    },
    "merkle": {
      "type": "object",
      "additionalProperties": false,
      "required": ["hash_alg", "pair_order", "path_sides"],
      "properties": {
        "hash_alg": { "type": "string", "enum": ["sha256"] },
        "pair_order": { "type": "string", "enum": ["LEFT_RIGHT_CONCAT"] },
        "path_sides": { "type": "string", "enum": ["EXPLICIT_LR"] }
      }
    },
    "manifest": {
      "type": "object",
      "additionalProperties": false,
      "required": ["hash_alg", "canonical_json_sha256"],
      "properties": {
        "hash_alg": { "type": "string", "enum": ["sha256"] },
        "canonical_json_sha256": { "type": "string", "pattern": "^[0-9a-f]{64}$" }
      }
    }
  }
}
